<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/index.js - xerror</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="xerror" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ObjectMask.html">ObjectMask</a></li>
                                <li><a href="../classes/objtools.html">objtools</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: lib/index.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
var ObjectMask = exports.ObjectMask = require(&#x27;./object-mask&#x27;);

/**
 * General utility functions for manipulating object.
 *
 * @class objtools
*/

/**
 * Determines whether a value is considered a scalar or an object.  Currently,
 * primitives plus Date types are considered scalar.
 *
 * @method isScalar
 * @static
 * @param {Mixed} o - Value to check
 * @return {Boolean}
 */
function isScalar(o) {
	return typeof o != &#x27;object&#x27; || (o instanceof Date) || !o;
}
exports.isScalar = isScalar;

/**
 * Checks whether two scalar values (as determined by isScalar()) are equal.
 *
 * @method scalarEquals
 * @static
 * @param {Mixed} a1 - First value
 * @param {Mixed} a2 - Second value
 * @return {Boolean}
 */
function scalarEquals(a1, a2) {
	if(a1 instanceof Date &amp;&amp; a2 instanceof Date) return a1.getTime() == a2.getTime();
	return a1 == a2;
}
exports.scalarEquals = scalarEquals;

/**
 * Returns a deep copy of the given value such that entities are not passed
 * by reference.
 *
 * @method deepCopy
 * @static
 * @param {Mixed} obj - The object or value to copy
 * @return {Mixed}
 */
function deepCopy(obj) {
	if(isScalar(obj)) return obj;
	var res;
	if(Array.isArray(obj)) {
		res = [];
		for(var i = 0; i &lt; obj.length; i++) {
			res.push(deepCopy(obj[i]));
		}
	} else {
		res = {};
		for(var key in obj) {
			res[key] = deepCopy(obj[key]);
		}
	}
	return res;
}
exports.deepCopy = deepCopy;

/**
 * Given an object, converts it into a one-level-deep object where the keys are dot-separated
 * paths and the values are the values at those paths.
 *
 * @method collapseToDotted
 * @static
 * @param {Object} obj - The object to convert
 * @param {Boolean} [includeRedundantLevels] - If set to true, the returned object also includes
 * keys for internal objects.  By default, an object such as { foo: { bar: &quot;baz&quot;} } will be converted
 * into { &quot;foo.bar&quot;: &quot;baz&quot; }.  If includeRedundantLevels is set, it will instead be converted
 * into { &quot;foo&quot;: { bar: &quot;baz&quot; }, &quot;foo.bar&quot;: &quot;baz&quot; } .
 * @param {Boolean} [stopAtArrays] - If set to true, the collapsing function will not descend into
 * arrays.
 * @example
 *   By default, an object such as { foo: [ &quot;bar&quot;, &quot;baz&quot; ] } is converted
 *   into { &quot;foo.0&quot;: &quot;bar&quot;, &quot;foo.1&quot;: &quot;baz&quot; }.  If stopAtArrays is set, this will instead be converted
 *   into { &quot;foo&quot;: [ &quot;bar&quot;, &quot;baz&quot; ] } .
 * @return {Object} - The result
 */
function collapseToDotted(obj, includeRedundantLevels, stopAtArrays) {
	if(isScalar(obj)) return {};
	var result = {};
	function addObj(obj, path) {
		if(isScalar(obj) || (Array.isArray(obj) &amp;&amp; stopAtArrays)) {
			result[path] = obj;
			return;
		}
		if(includeRedundantLevels) {
			result[path] = obj;
		}
		for(var key in obj) {
			addObj(obj[key], path ? (path + &#x27;.&#x27; + key) : key);
		}
	}
	addObj(obj, &#x27;&#x27;);
	delete result[&#x27;&#x27;];
	return result;
}
exports.collapseToDotted = collapseToDotted;

/**
 * Returns whether or not the given query fields (in dotted notation) match the document
 * (also in dotted notation).  The &quot;queries&quot; here are simple equality matches.
 *
 * @method matchDottedObject
 * @static
 * @param {Object} doc - The document to test
 * @param {Object} query - A one-layer-deep set of key/values to check doc for
 * @return {Boolean} - Whether or not the doc matches
 */
function matchDottedObject(doc, query) {
	if(query === true) return doc === true;
	if(isScalar(query) || isScalar(doc)) return query === doc;
	for(var queryKey in query) {
		if(doc[queryKey] !== query[queryKey]) {
			return false;
		}
	}
	return true;
}
exports.matchDottedObject = matchDottedObject;

/**
 * Same as matchDottedObject, but allows for non-dotted objects and queries.
 *
 * @method matchObject
 * @static
 * @param {Object} doc - Object to match against, in structured (not dotted) form
 * @param {Object} query - Set of fields (either dotted or structured) to match
 * @return {Boolean} - Whether or not the object matches
 */
function matchObject(doc, query) {
	return matchDottedObject(exports.collapseToDotted(doc), exports.collapseToDotted(query));
}
exports.matchObject = matchObject;

/**
 * Checks for deep equality between two object or values.
 *
 * @method deepEquals
 * @static
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean}
 */
function deepEquals(a, b) {
	if(isScalar(a) &amp;&amp; isScalar(b)) {
		if(a instanceof Date &amp;&amp; b instanceof Date) {
			return a.getTime() == b.getTime();
		} else {
			return a === b;
		}
	}
	if(a === null || b === null || a === undefined || b === undefined) return a === b;
	if(Array.isArray(a) &amp;&amp; Array.isArray(b)) {
		if(a.length != b.length) return false;
		for(var i = 0; i &lt; a.length; i++) if(a[i] !== b[i]) return false;
		return true;
	} else if(!Array.isArray(a) &amp;&amp; !Array.isArray(b)) {
		if(!Object.keys(a).every(function(k) {
			return deepEquals(a[k], b[k]);
		})) return false;
		if(!Object.keys(b).every(function(k) {
			return deepEquals(a[k], b[k]);
		})) return false;
	} else {
		return false;
	}
}
exports.deepEquals = deepEquals;

/**
 * Sets the value at a given path in an object.
 *
 * @method setPath
 * @static
 * @param {Object} obj - The object
 * @param {String} path - The path, dot-separated
 * @param {Mixed} value - Value to set
 * @return {Object} - The same object
 */
function setPath(obj, path, value) {
	var cur = obj;
	var parts = path.split(&#x27;.&#x27;);
	for(var i = 0; i &lt; parts.length; i++) {
		if(i === parts.length - 1) cur[parts[i]] = value;
		else {
			if(isScalar(cur[parts[i]])) cur[parts[i]] = {};
			cur = cur[parts[i]];
		}
	}
	return obj;
}
exports.setPath = setPath;

/**
 * Deletes the value at a given path in an object.
 *
 * @method deletePath
 * @static
 * @param {Object} obj
 * @param {String} path
 * @return {Object} - The object that was passed in
 */
function deletePath(obj, path) {
	var cur = obj;
	var parts = path.split(&#x27;.&#x27;);
	for(var i = 0; i &lt; parts.length; i++) {
		if(i === parts.length - 1) delete cur[parts[i]];
		else {
			if(isScalar(cur[parts[i]])) {
				return obj;
			}
			cur = cur[parts[i]];
		}
	}
	return obj;
}
exports.deletePath = deletePath;

/**
 * Gets the value at a given path in an object.
 *
 * @method getPath
 * @static
 * @param {Object} obj - The object
 * @param {String} path - The path, dot-separated
 * @param {Boolean} allowSkipArrays - If true: If a field in an object is an array and the
 * path key is non-numeric, and the array has exactly 1 element, then the first element
 * of the array is used.
 * @return {Mixed} - The value at the path
 */
function getPath(obj, path, allowSkipArrays) {
	var cur = obj;
	var parts = path.split(&#x27;.&#x27;);
	for(var i = 0; i &lt; parts.length; i++) {
		if(isScalar(cur)) return undefined;
		if(Array.isArray(cur) &amp;&amp; allowSkipArrays &amp;&amp; !(/^[0-9]+$/.test(parts[i])) &amp;&amp; cur.length == 1) {
			cur = cur[0];
			i--;
		} else {
			cur = cur[parts[i]];
		}
	}
	return cur;
}
exports.getPath = getPath;


    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
