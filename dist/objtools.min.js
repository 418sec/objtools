/** objtools.min.js - v0.0.16 - Tue, 11 Nov 2014 20:52:22 GMT */
!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),(e.ZSModule||(e.ZSModule={})).objtools=r()}}(function(){return function r(e,t,i){function n(u,a){if(!t[u]){if(!e[u]){var f="function"==typeof require&&require;if(!a&&f)return f(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var s=t[u]={exports:{}};e[u][0].call(s.exports,function(r){var t=e[u][1][r];return n(t?t:r)},s,s.exports,r,e,t,i)}return t[u].exports}for(var o="function"==typeof require&&require,u=0;u<i.length;u++)n(i[u]);return n}({objtools:[function(r,e,t){function i(r){return"object"!=typeof r||r instanceof Date||!r}function n(r,e){return r instanceof Date&&e instanceof Date?r.getTime()==e.getTime():r==e}function o(r,e,t){function n(r,e,o){if(e===!0)return r;if(!e||i(r))return void(t&&t(o));if(Array.isArray(e)&&(e={_:e[0]||!1}),"object"==typeof e){var u,a,f=Array.isArray(r),l=f?[]:{};for(var s in r)u=void 0===e[s]?e._:e[s],a=n(r[s],u||!1,o?o+"."+s:s),void 0!==a&&(f?l.push(a):l[s]=a);return l}return void(t&&t(o))}return n(r,e,"")}function u(r,e){for(var t=e.split("."),n=r,o=0;o<t.length;o++){if(n===!0)return!0;if(i(n))return!1;Array.isArray(n)&&(n={_:n[0]||!1});var u=t[o];n=void 0===n[u]?n._:n[u]}return n||!1}function a(r,e){return u(r,e)===!0}function f(){function r(e,t){var n;if(e===!0)return!0;if(t===!0)return e=!0;if(i(t))return e;if(i(e))return e=l(t);if(Array.isArray(e)&&(e={_:e[0]||!1}),Array.isArray(t)&&(t={_:t[0]||!1}),void 0!==t._)for(n in e)"_"!==n&&void 0===t[n]&&(e[n]=r(e[n],t._));for(n in t)"_"!==n&&(e[n]=void 0!==e[n]?r(e[n],t[n]):void 0!==e._?r(l(t[n]),e._):l(t[n]));return void 0!==t._&&(e._=void 0!==e._?r(e._,t._):l(t._)),e||!1}for(var e=!1,t=0;t<arguments.length;t++)if(e=r(e,arguments[t]),e===!0)return!0;return e||!1}function l(r){if(i(r))return r;var e;if(Array.isArray(r)){e=[];for(var t=0;t<r.length;t++)e.push(l(r[t]))}else{e={};for(var n in r)e[n]=l(r[n])}return e}function s(){function r(e,t){var n;if(e===!0)return l(t);if(t===!0)return e;if(i(e)||i(t))return!1;Array.isArray(e)&&(e={_:e[0]||!1}),Array.isArray(t)&&(t={_:t[0]||!1});for(n in t)"_"!==n&&void 0!==e[n]&&(e[n]=r(e[n],t[n]));for(n in e)"_"!==n&&void 0===t[n]&&(e[n]=void 0!==t._?r(e[n],t._):!1);for(n in t)"_"!==n&&void 0===e[n]&&(e[n]=void 0!==e._?r(l(t[n]),e._):!1);if(void 0!==t._&&void 0!==e._?e._=r(e._,t._):delete e._,!e._){delete e._;for(n in e)e[n]||delete e[n]}return Object.keys(e).length?e:!1}for(var e=!0,t=0;t<arguments.length;t++)if(e=r(e,arguments[t]),e===!1)return!1;return e||!1}function c(r,e,t){function n(r,u){if(i(r)||Array.isArray(r)&&t)return void(o[u]=r);e&&(o[u]=r);for(var a in r)n(r[a],u?u+"."+a:a)}if(i(r))return{};var o={};return n(r,""),delete o[""],o}function d(r,e){var t=[];return o(r,e,function(r){t.push(r)}),t}function v(r,e){if(i(r)&&i(e))return r instanceof Date&&e instanceof Date?r.getTime()==e.getTime():r===e;if(null===r||null===e||void 0===r||void 0===e)return r===e;if(Array.isArray(r)&&Array.isArray(e)){if(r.length!=e.length)return!1;for(var t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}return Array.isArray(r)||Array.isArray(e)?!1:Object.keys(r).every(function(t){return v(r[t],e[t])})&&Object.keys(e).every(function(t){return v(r[t],e[t])})?void 0:!1}t.isScalar=i,t.scalarEquals=n,t.filterObj=o,t.whitelistFilterDocument=o,t.filterObjByMask=o,t.getSubMask=u,t.checkMaskPath=a,t.combineWhitelists=f,t.addObjFilters=f,t.addMasks=f,t.deepCopy=l,t.andMasks=s,t.combineAndWhitelists=s,t.intersectObjFilters=s,t.validateWhitelist=function(r){if(r!==!0&&r!==!1&&("object"!=typeof r||null===r))return!1;if("object"==typeof r)for(var e in r)if(!t.validateWhitelist(r[e]))return!1;return!0},t.validateObjFilter=t.validateWhitelist,t.validateMask=t.validateWhitelist,t.collapseDocumentToDotted=c,t.collapseObj=c,t.collapseToDotted=c,t.getMaskedOutFields=d,t.listFilteredOutFields=d,t.getNotWhitelistedFields=d,t.checkWhitelistFields=function(r,e){return 0===d(r,e).length},t.checkObjWhitelist=t.checkWhitelistFields,t.checkDottedWhitelistFields=function(r,e){return Object.keys(r).every(function(r){return a(e,r)})},t.checkDottedObjWhitelist=t.checkDottedWhitelistFields,t.getDottedNotWhitelistedFields=function(r,e){function t(r,e){if(e===!0)return!0;if(!e)return!1;var n=r[0],o=!isNaN(parseInt(n,10));return o?Array.isArray(e)?1!=e.length?(console.log("Invalid whitelist at "+n),!1):t(r.slice(1),e[0]):!1:i(e)?!1:t(r.slice(1),e[n])}var n=[];for(var o in r)t(o.split("."),e)||n.push(o);return n},t.listFilteredOutFieldsDotted=t.getDottedNotWhitelistedFields,t.validateNoOperators=function(r){if(!i(r))for(var e in r){if("$"==e[0])return!1;if(!t.validateNoOperators(r[e]))return!1}return!0},t.applyUpdate=function(r,e,i){return e&&(e=t.collapseDocumentToDotted(e)),i&&!t.checkDottedWhitelistFields(e,i)?null:t.applyDottedUpdate(r,e)},t.applyDottedUpdate=function(r,e,i){return Object.keys(e).forEach(function(n){void 0===typeof e[n]||null===e[n]?i&&t.setPath(r,n,void 0):t.setPath(r,n,e[n]),r.markModified&&r.markModified(n)}),r},t.matchDocument=function(r,e){if(e===!0)return r===!0;if(i(e)||i(r))return e===r;for(var t in e)if(r[t]!==e[t])return!1;return!0},t.matchObj=t.matchDocument,t.matchStructuredDocument=function(r,e){return t.matchDocument(t.collapseDocumentToDotted(r),t.collapseDocumentToDotted(e))},t.matchStructuredObj=t.matchStructuredDocument,t.inheritDocument=function(){function r(r,e){return i(r)?!1:Object.keys(r).length?e?Object.keys(r).sort(function(r,e){var t=parseInt(r,10)-parseInt(e,10);return isNaN(t)?0:void 0}).every(function(r,e){return""+r==""+e}):Object.keys(r).every(function(r){return/^[0-9]+$/.test(r)}):!1}function e(t,n){var o;if(null===n||void 0===n)return void 0;if(i(n))return n;if(n._delete===!0)return void 0;if(n.array===!0){if(Array.isArray(n.replace||n._replace))return n.replace||n._replace;var u=[];if(Array.isArray(t)&&u.push.apply(u,t),Array.isArray(n.add)&&n.add.forEach(function(r){-1===u.indexOf(r)&&u.push(r)}),Array.isArray(n.remove)){var a=[];u.forEach(function(r){-1===n.remove.indexOf(r)&&a.push(r)}),u=a}return u}var f;if(f=Array.isArray(n)?[]:t&&Array.isArray(t)&&(void 0===n||r(n))?[]:{},i(t))return e(f,n);if(n._replace)return e(f,n);var l=f;if(t&&!Array.isArray(n))for(o in t)l[o]=t[o];for(o in n)void 0!==n[o]&&(null!==n[o]||void 0===l[o]||n._yield?l[o]=void 0===l[o]||n._yield?e(Array.isArray(n[o])?[]:{},n[o]):e(l[o],n[o]):delete l[o]);for(o in l)(void 0===l[o]||null===l[o])&&delete l[o];return Array.isArray(l)&&(l=l.filter(function(r){return null!==r&&void 0!==r})),l}for(var t,n=0;n<arguments.length;n++)t=e(t,arguments[n]);return delete t._replace,delete t._yield,delete t._delete,t},t.inherit=t.inheritDocument,t.deepEquals=v,t.inheritDiff=function(r,e){if(v(r,e))return void 0;if(i(r)||i(e))return e;if(Array.isArray(r)||Array.isArray(e))return e;var n={};return Object.keys(e).forEach(function(i){if(!v(r[i],e[i])){var o=t.inheritDiff(r[i],e[i]);void 0!==o&&(n[i]=o)}}),Object.keys(r).forEach(function(r){void 0===e[r]&&(n[r]=null)}),n},t.setPath=function(r,e,t){for(var n=r,o=e.split("."),u=0;u<o.length;u++)u===o.length-1?n[o[u]]=t:(i(n[o[u]])&&(n[o[u]]={}),n=n[o[u]]);return r},t.deletePath=function(r,e){for(var t=r,n=e.split("."),o=0;o<n.length;o++)if(o===n.length-1)delete t[n[o]];else{if(i(t[n[o]]))return r;t=t[n[o]]}return r},t.getPath=function(r,e,t){for(var n=r,o=e.split("."),u=0;u<o.length;u++){if(i(n))return void 0;Array.isArray(n)&&t&&!/^[0-9]+$/.test(o[u])&&1==n.length?(n=n[0],u--):n=n[o[u]]}return n},t.createMaskFromFieldList=function(r){for(var e={},i=0;i<r.length;i++)t.setPath(e,r[i],!0);return e},t.createFilterFromMask=function(r){return function(e){t.filterObj(e,r)}}},{}]},{},[])("objtools")});