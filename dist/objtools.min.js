/** objtools.min.js - v0.0.7 - Fri, 19 Sep 2014 20:42:03 GMT */
!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),(e.ZS||(e.ZS={})).objtools=r()}}(function(){return function r(e,t,i){function n(a,u){if(!t[a]){if(!e[a]){var l="function"==typeof require&&require;if(!u&&l)return l(a,!0);if(o)return o(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var s=t[a]={exports:{}};e[a][0].call(s.exports,function(r){var t=e[a][1][r];return n(t?t:r)},s,s.exports,r,e,t,i)}return t[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({objtools:[function(r,e,t){function i(r){return"object"!=typeof r||r instanceof Date||!r}function n(r,e){return r instanceof Date&&e instanceof Date?r.getTime()==e.getTime():r==e}function o(r,e){if(i(r)&&i(e))return r instanceof Date&&e instanceof Date?r.getTime()==e.getTime():r===e;if(null===r||null===e||void 0===r||void 0===e)return r===e;if(Array.isArray(r)&&Array.isArray(e)){if(r.length!=e.length)return!1;for(var t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}return Array.isArray(r)||Array.isArray(e)?!1:Object.keys(r).every(function(t){return o(r[t],e[t])})&&Object.keys(e).every(function(t){return o(r[t],e[t])})?void 0:!1}t.isScalar=i,t.scalarEquals=n,t.whitelistFilterDocument=function(r,e){if(e===!0||"*"===e)return r;if(Array.isArray(e)){if(!Array.isArray(r))return void 0;if(1!=e.length)return void 0;var i=[];return r.forEach(function(r){i.push(t.whitelistFilterDocument(r,e[0]))}),i}if("object"==typeof e){if("object"!=typeof r)return void 0;var n={};for(var o in e)if(void 0!==r[o]){var a=t.whitelistFilterDocument(r[o],e[o]);void 0!==a&&(n[o]=a)}return n}return void 0},t.filterObj=t.whitelistFilterDocument,t.combineWhitelists=function(){function r(e,t){if(t)for(var i in t)if((!Array.isArray(e)||"length"!=i&&!Array.prototype[i])&&e[i]!==!0&&void 0!==t[i])if(void 0!==e[i]&&t[i]!==!0)if(Array.isArray(e[i])&&!Array.isArray(t[i])||!Array.isArray(e[i])&&Array.isArray(t[i]))console.log("Warning: Whitelist schemas do not match at "+i);else if(Array.isArray(e[i])){if(1!=e[i].length||1!=t[i].length){console.log("Warning: Invalid whitelist schema at "+i);continue}r(e[i],t[i])}else"object"!=typeof e[i]||"object"!=typeof t[i]?console.log("Warning: Invalid whitelist schema at "+i):r(e[i],t[i]);else e[i]=t[i]}for(var e={},t=0;t<arguments.length;t++){if(arguments[t]===!0){e=!0;break}r(e,arguments[t])}return e},t.addObjFilters=t.combineWhitelists,t.combineAndWhitelists=function(){function r(e,t){var i,n;if(!e||!t)return!1;if(e===!0)return t;if(t===!0)return e;if("object"==typeof e&&"object"==typeof t){if(Array.isArray(e)&&Array.isArray(t))return 1!=e.length||1!=t.length?(console.log("Warning: Invalid whitelist schema"),!1):[r(e[0],t[0])];if(Array.isArray(e)){if(1!=e.length)return console.log("Warning: Invalid whitelist schema"),!1;n={};for(i in t)n[i]=r(t[i],e[0]);return n}if(Array.isArray(t)){if(1!=t.length)return console.log("Warning: Invalid whitelist schema"),!1;n={};for(i in e)n[i]=r(e[i],t[0]);return n}n={};for(i in e){var o=r(e[i],t[i]);o&&(n[i]=o)}return n}return console.log("Warning: Invalid whitelist schema"),!1}for(var e=!0,t=0;t<arguments.length;t++)e=r(e,arguments[t]);return e},t.intersectObjFilters=t.combineAndWhitelists,t.validateWhitelist=function(r){if(r!==!0&&"object"!=typeof r)return!1;if("object"==typeof r)for(var e in r)if(!t.validateWhitelist(r[e]))return!1;return!0},t.validateObjFilter=t.validateWhitelist,t.getNotWhitelistedFields=function(r,e){function t(r,e,o){if(e!==!0){if(!e)return void n.push(o);if(i(r))return void n.push(o);for(var a in r){var u=r[a],l=o?o+"."+a:a,f=Array.isArray(e)?e[0]:e[a];f?f!==!0&&(i(u)||i(f)?n.push(l):t(u,f,l)):n.push(l)}}}var n=[];return t(r,e,""),n},t.listFilteredOutFields=t.getNotWhitelistedFields,t.checkWhitelistFields=function(r,e){if(e===!0)return!0;if(!e)return!1;if(i(r)||i(e))return!1;for(var n in r){if(!e[n])return!1;var o=e[n],a=r[n];if(o!==!0){if(!a)return!1;if(Array.isArray(a)&&Array.isArray(o)){if(1!=o.length)return console.log("Warning: Invalid whitelist schema at "+n),!1;var u=!0;if(a.forEach(function(r){t.checkWhitelistFields(r,o[0])||(u=!1)}),!u)return!1}else{if(Array.isArray(r)||Array.isArray(e))return!1;if(i(a)||i(o))return!1;if(!t.checkWhitelistFields(a,o))return!1}}}return!0},t.checkObjWhitelist=t.checkWhitelistFields,t.checkDottedWhitelistFields=function(r,e){function t(r,e){if(e===!0)return!0;if(!e)return!1;var n=r[0],o=!isNaN(parseInt(n,10));return o?Array.isArray(e)?1!=e.length?(console.log("Invalid whitelist at "+n),!1):t(r.slice(1),e[0]):!1:i(e)?!1:t(r.slice(1),e[n])}for(var n in r)if(!t(n.split("."),e))return!1;return!0},t.checkDottedObjWhitelist=t.checkDottedWhitelistFields,t.getDottedNotWhitelistedFields=function(r,e){function t(r,e){if(e===!0)return!0;if(!e)return!1;var n=r[0],o=!isNaN(parseInt(n,10));return o?Array.isArray(e)?1!=e.length?(console.log("Invalid whitelist at "+n),!1):t(r.slice(1),e[0]):!1:i(e)?!1:t(r.slice(1),e[n])}var n=[];for(var o in r)t(o.split("."),e)||n.push(o);return n},t.listFilteredOutFieldsDotted=t.getDottedNotWhitelistedFields,t.validateNoOperators=function(r){if(!i(r))for(var e in r){if("$"==e[0])return!1;if(!t.validateNoOperators(r[e]))return!1}return!0},t.collapseDocumentToDotted=function(r){function e(r,o){if(i(o)||Array.isArray(o))void 0!==t[r]?n.push(r):t[r]=o;else for(var a in o){var u;u=""===r?a:r+"."+a,e(u,o[a])}}if(i(r))return r;var t={},n=[];return e("",r),n.length>0?null:t},t.collapseObj=t.collapseDocumentToDotted,t.applyUpdate=function(r,e,i){return e&&(e=t.collapseDocumentToDotted(e)),i&&!t.checkDottedWhitelistFields(e,i)?null:t.applyDottedUpdate(r,e)},t.applyDottedUpdate=function(r,e,i){return Object.keys(e).forEach(function(n){void 0===typeof e[n]||null===e[n]?i&&t.setPath(r,n,void 0):t.setPath(r,n,e[n]),r.markModified&&r.markModified(n)}),r},t.matchDocument=function(r,e){if(e===!0)return r===!0;if(i(e)||i(r))return e===r;for(var t in e)if(r[t]!==e[t])return!1;return!0},t.matchObj=t.matchDocument,t.matchStructuredDocument=function(r,e){return t.matchDocument(t.collapseDocumentToDotted(r),t.collapseDocumentToDotted(e))},t.matchStructuredObj=t.matchStructuredDocument,t.inheritDocument=function(){function r(r,e){return i(r)?!1:Object.keys(r).length?e?Object.keys(r).sort(function(r,e){var t=parseInt(r,10)-parseInt(e,10);return isNaN(t)?0:void 0}).every(function(r,e){return""+r==""+e}):Object.keys(r).every(function(r){return/^[0-9]+$/.test(r)}):!1}function e(t,n){var o;if(null===n||void 0===n)return void 0;if(i(n))return n;if(n._delete===!0)return void 0;if(n.array===!0){if(Array.isArray(n.replace||n._replace))return n.replace||n._replace;var a=[];if(Array.isArray(t)&&a.push.apply(a,t),Array.isArray(n.add)&&n.add.forEach(function(r){-1===a.indexOf(r)&&a.push(r)}),Array.isArray(n.remove)){var u=[];a.forEach(function(r){-1===n.remove.indexOf(r)&&u.push(r)}),a=u}return a}var l;if(l=Array.isArray(n)?[]:t&&Array.isArray(t)&&(void 0===n||r(n))?[]:{},i(t))return e(l,n);if(n._replace)return e(l,n);var f=l;if(t&&!Array.isArray(n))for(o in t)f[o]=t[o];for(o in n)void 0!==n[o]&&(null!==n[o]||void 0===f[o]||n._yield?f[o]=void 0===f[o]||n._yield?e(Array.isArray(n[o])?[]:{},n[o]):e(f[o],n[o]):delete f[o]);for(o in f)(void 0===f[o]||null===f[o])&&delete f[o];return Array.isArray(f)&&(f=f.filter(function(r){return null!==r&&void 0!==r})),f}for(var t,n=0;n<arguments.length;n++)t=e(t,arguments[n]);return delete t._replace,delete t._yield,delete t._delete,t},t.inherit=t.inheritDocument,t.deepEquals=o,t.inheritDiff=function(r,e){if(o(r,e))return void 0;if(i(r)||i(e))return e;if(Array.isArray(r)||Array.isArray(e))return e;var n={};return Object.keys(e).forEach(function(i){if(!o(r[i],e[i])){var a=t.inheritDiff(r[i],e[i]);void 0!==a&&(n[i]=a)}}),Object.keys(r).forEach(function(r){void 0===e[r]&&(n[r]=null)}),n},t.setPath=function(r,e,t){for(var n=r,o=e.split("."),a=0;a<o.length;a++)a===o.length-1?n[o[a]]=t:(i(n[o[a]])&&(n[o[a]]={}),n=n[o[a]]);return r},t.deletePath=function(r,e){for(var t=r,n=e.split("."),o=0;o<n.length;o++)if(o===n.length-1)delete t[n[o]];else{if(i(t[n[o]]))return r;t=t[n[o]]}return r},t.getPath=function(r,e,t){for(var n=r,o=e.split("."),a=0;a<o.length;a++){if(i(n))return void 0;Array.isArray(n)&&t&&!/^[0-9]+$/.test(o[a])&&1==n.length?(n=n[0],a--):n=n[o[a]]}return n},t.createMaskFromFieldList=function(r){for(var e={},i=0;i<r.length;i++)t.setPath(e,r[i],!0);return e},t.createFilterFromMask=function(r){return function(e){t.filterObj(e,r)}}},{}]},{},[])("objtools")});